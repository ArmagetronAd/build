#!/bin/bash

#set -x

root=$(dirname "${0}")
EXEC=$(grep -m 1 -r Exec= ${root}/*.desktop | cut -d "=" -f 2 | cut -d % -f 1)
# append library path so system libraries are found first (if we put our libs into /usr/lib),
# same for executables.

# true portable app: create a .armagetronad directory in the current directory and
# it'll be used to store your data.
extraarg=
test -d .${EXEC} && extraarg="--userdatadir .${EXEC}"

# for debugging: if LD_DEBUG_APP=true, use the included libraries first.
# you can then use strace to check no non-standard external libraries are needed. 
extralibs=
test "x${LD_DEBUG_APP}" = xtrue || extralib=:/usr/local/lib32:/usr/local/lib:/usr/lib32:/usr/lib

LD_LIBRARY_PATH="${root}/usr/local/lib:${LD_LIBRARY_PATH}:${root}/usr/lib" PATH="${root}/usr/local/bin:${PATH}:${extralib}${root}/usr/bin" exec $EXEC ${extraarg} $@
